<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Index</title>
</head>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/css/bootstrap.min.css"
      integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://cdn.bootcss.com/jquery/3.4.1/jquery.min.js"></script>
<script src="https://unpkg.com/axios/dist/axios.min.js"></script>

<body>
<div style="margin-left: 300px;margin-right: 300px;margin-top: 100px;">
    <div class="page-header">
        <h1>Excel Change For Work
            <small>test</small>
        </h1>
    </div>

    <div>
        <form>
            <label>1.Chinese name get pinyin</label>
            <div class="form-group">
                <label for="exampleInputFile">Excel</label>
                <input type="file" id="exampleInputFile">
            </div>
            <button type="button" class="btn  btn-success" onclick="getPinyin()">Submit</button>
        </form>
    </div>

    <div style="padding-top: 50px">
        <form>
            <label>2.Rename image </label>
            <div class="form-group">
                <label for="commonName">Common Name</label>
                <input type="test" class="form-control" id="commonName" placeholder="Common Name">
            </div>

            <div class="form-group">
                <label for="excelFile">Excel</label>
                <input type="file" id="excelFile">
            </div>

            <div class="form-group">
                <label for="imageFile">Images</label>
                <input type="file" id="imageFile" multiple>
            </div>
            <button type="button" class="btn  btn-info" onclick="nameImage()">Submit</button>
        </form>
    </div>
</div>
</body>
</html>

<script>

    /**
     * chinese name get pinyin
     */
    function getPinyin() {
        var formData = new FormData();
        formData.append('excel', $('#exampleInputFile')[0].files[0]);
        $.ajax({
            url: "http://localhost:8090/Excel-Change/public/api/import-excel-get-py",
            data: formData,
            dataType: "JSON",
            type: 'POST',
            contentType: false,
            processData: false,
            success: function (result) {
                if (result.code) {
                    window.location.href = result.message;
                } else {
                    alert(result.message);
                }
            },
        });
    }


    function nameImage() {
        var formData = new FormData();
        var imageData = $('#imageFile')[0].files;
        formData.append('common', $('#commonName').val());
        formData.append('excel', $('#excelFile')[0].files[0]);
        for (var i = 0; i < imageData.length; i++) {
            formData.append('img[]', imageData[i]);
        }
        $.ajax({
            url: "http://localhost:8090/Excel-Change/public/api/img-change-name",
            data: formData,
            dataType: "JSON",
            type: 'POST',
            contentType: false,
            processData: false,
            success: function (result) {
                if (result.code) {
                    window.location.href = result.message;
                } else {
                    alert(result.message);
                }
            },
        });
    }

</script>


